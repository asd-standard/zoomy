<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Unit Testing Guide &#8212; PyZui 0.11 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=cc7d0dec" />
    <script src="../_static/documentation_options.js?v=086c1757"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Integration Testing Guide" href="integrationtest.html" />
    <link rel="prev" title="Logging System" href="../technicaldocumentation/logging.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="unit-testing-guide">
<h1>Unit Testing Guide<a class="headerlink" href="#unit-testing-guide" title="Link to this heading">¶</a></h1>
<p>This document provides a comprehensive guide to unit testing PyZUI during development,
including testing patterns, best practices, and guidelines for writing new tests.
The PyZUI test suite uses pytest with BDD-style documentation and comprehensive coverage
of all major components.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The PyZUI unit test suite is designed to:</p>
<ol class="arabic simple">
<li><p>Validate core functionality of all components</p></li>
<li><p>Prevent regressions during development</p></li>
<li><p>Document expected behavior through tests</p></li>
<li><p>Enable confident refactoring</p></li>
<li><p>Catch bugs early in the development cycle</p></li>
</ol>
<p><strong>Test Framework</strong>: pytest (Python Testing Framework)</p>
<p><strong>Testing Style</strong>: Behavior-Driven Development (BDD) with Given-When-Then scenarios</p>
<p><strong>Coverage Areas</strong>:
- Objects system (PhysicalObject, MediaObject, Scene)
- Tile system (TileCache, TileManager, TileProviders)
- Converters (PDF, Vips)
- Windows (MainWindow, QZUI, Dialogs)</p>
</section>
<section id="test-suite-structure">
<h2>Test Suite Structure<a class="headerlink" href="#test-suite-structure" title="Link to this heading">¶</a></h2>
<section id="directory-organization">
<h3>Directory Organization<a class="headerlink" href="#directory-organization" title="Link to this heading">¶</a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>test/unittest/
├── conftest.py                    # Pytest configuration
├── objects/                       # Object system tests
│   ├── mediaobjects/
│   │   ├── test_physicalobject.py
│   │   ├── test_mediaobject.py
│   │   ├── test_tiledmediaobject.py
│   │   ├── test_stringmediaobject.py
│   │   └── test_svgmediaobject.py
│   └── scene/
│       ├── test_scene.py
│       └── test_qzui.py
├── tilesystem/                    # Tile system tests
│   ├── test_tilecache.py
│   ├── test_tilemanager.py
│   ├── test_tile.py
│   ├── tileproviders/
│   │   ├── test_tileprovider.py
│   │   ├── test_statictileprovider.py
│   │   ├── test_dynamictileprovider.py
│   │   └── test_ferndynamictileprovider.py
│   ├── tiler/
│   │   ├── test_tiler.py
│   │   └── test_ppm.py
│   └── tilestore/
│       ├── test_tilestore.py
│       └── test_cleanuptilestore.py
├── converters/                    # Converter tests
│   ├── test_converter.py
│   ├── test_pdfconverter.py
│   └── test_vipsconverter.py
├── windows/                       # Window system tests
│   └── dialogwindows/
│       ├── test_mainwindow.py
│       └── test_dialogwindows.py
└── test_new_dynamictileprovider_TEMPLATE.py  # Template for new tests
</pre></div>
</div>
</section>
<section id="configuration-files">
<h3>Configuration Files<a class="headerlink" href="#configuration-files" title="Link to this heading">¶</a></h3>
<p><strong>conftest.py</strong></p>
<p>Located at <code class="docutils literal notranslate"><span class="pre">test/unittest/conftest.py</span></code>, this file configures pytest for the test suite:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pytest configuration file for unittest directory.</span>
<span class="sd">Sets up Python path so tests can import from pyzui package.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="c1"># Add pyzui root to Python path</span>
<span class="n">pyzui_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../..&#39;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">pyzui_root</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pyzui_root</span><span class="p">)</span>
</pre></div>
</div>
<p>This ensures all tests can import from the <code class="docutils literal notranslate"><span class="pre">pyzui</span></code> package regardless of
the current working directory.</p>
</section>
</section>
<section id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Link to this heading">¶</a></h2>
<section id="basic-usage">
<h3>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading">¶</a></h3>
<p><strong>Run all unit tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>test/unittest
pytest
</pre></div>
</div>
<p><strong>Run with verbose output:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-v
</pre></div>
</div>
<p><strong>Run specific test file:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>objects/mediaobjects/test_physicalobject.py
</pre></div>
</div>
<p><strong>Run specific test class:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>objects/mediaobjects/test_physicalobject.py::TestPhysicalObject
</pre></div>
</div>
<p><strong>Run specific test method:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>objects/mediaobjects/test_physicalobject.py::TestPhysicalObject::test_init
</pre></div>
</div>
</section>
<section id="advanced-options">
<h3>Advanced Options<a class="headerlink" href="#advanced-options" title="Link to this heading">¶</a></h3>
<p><strong>Show print statements:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-v<span class="w"> </span>-s
</pre></div>
</div>
<p><strong>Stop on first failure:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-x
</pre></div>
</div>
<p><strong>Show local variables on failure:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-l
</pre></div>
</div>
<p><strong>Run tests in parallel (requires pytest-xdist):</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-n<span class="w"> </span>auto
</pre></div>
</div>
<p><strong>Generate HTML coverage report:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--cov<span class="o">=</span>pyzui<span class="w"> </span>--cov-report<span class="o">=</span>html
<span class="c1"># Open htmlcov/index.html in browser</span>
</pre></div>
</div>
<p><strong>Run only tests matching pattern:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-k<span class="w"> </span><span class="s2">&quot;tile&quot;</span><span class="w">  </span><span class="c1"># Runs all tests with &#39;tile&#39; in name</span>
</pre></div>
</div>
<p><strong>Run tests marked with specific marker:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;integration&quot;</span><span class="w">  </span><span class="c1"># If using markers</span>
</pre></div>
</div>
</section>
</section>
<section id="test-organization-patterns">
<h2>Test Organization Patterns<a class="headerlink" href="#test-organization-patterns" title="Link to this heading">¶</a></h2>
<section id="test-class-structure">
<h3>Test Class Structure<a class="headerlink" href="#test-class-structure" title="Link to this heading">¶</a></h3>
<p>Every test module should follow this structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">MagicMock</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyzui.module</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassToTest</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestClassName</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature: Class Description</span>

<span class="sd">    High-level description of what this class does and why it&#39;s being tested.</span>
<span class="sd">    Explains the component&#39;s role in the system.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_specific_behavior</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scenario: Describe the test scenario</span>

<span class="sd">        Given &lt;preconditions&gt;</span>
<span class="sd">        When &lt;action performed&gt;</span>
<span class="sd">        Then &lt;expected outcome&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Arrange</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassToTest</span><span class="p">()</span>

        <span class="c1"># Act</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>

        <span class="c1"># Assert</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected_value</span>
</pre></div>
</div>
</section>
<section id="bdd-style-documentation">
<h3>BDD-Style Documentation<a class="headerlink" href="#bdd-style-documentation" title="Link to this heading">¶</a></h3>
<p>All tests use Given-When-Then format in docstrings:</p>
<p><strong>Given</strong>: Preconditions and setup
<strong>When</strong>: Action or event
<strong>Then</strong>: Expected outcome</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scenario: Move object to new position</span>

<span class="sd">    Given a PhysicalObject at the origin</span>
<span class="sd">    When calling move with x=10 and y=20</span>
<span class="sd">    Then the object position should be updated to (10, 20)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">10.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="mf">20.0</span>
</pre></div>
</div>
</section>
<section id="test-categories">
<h3>Test Categories<a class="headerlink" href="#test-categories" title="Link to this heading">¶</a></h3>
<p><strong>1. Initialization Tests</strong></p>
<p>Test object construction and default values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test object initialization with default values.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">0.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="mf">0.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_z</span> <span class="o">==</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p><strong>2. Property Tests</strong></p>
<p>Test getters and setters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_zoomlevel_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test zoomlevel property getter and setter.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">zoomlevel</span> <span class="o">=</span> <span class="mf">5.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">zoomlevel</span> <span class="o">==</span> <span class="mf">5.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_z</span> <span class="o">==</span> <span class="mf">5.0</span>
</pre></div>
</div>
<p><strong>3. Method Tests</strong></p>
<p>Test individual methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test move method updates position.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">10.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="mf">20.0</span>
</pre></div>
</div>
<p><strong>4. Edge Case Tests</strong></p>
<p>Test boundary conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_move_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test move with negative coordinates.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="o">-</span><span class="mf">5.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="o">-</span><span class="mf">10.0</span>
</pre></div>
</div>
<p><strong>5. Integration Tests</strong></p>
<p>Test with real dependencies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_small_image_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Integration test for PNG conversion.&quot;&quot;&quot;</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="s2">&quot;data/test.png&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">infile</span><span class="p">):</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test file not found: </span><span class="si">{</span><span class="n">infile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">converter</span> <span class="o">=</span> <span class="n">VipsConverter</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">outfile</span><span class="p">)</span>
    <span class="n">converter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">converter</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">converter</span><span class="o">.</span><span class="n">error</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="mocking-strategies">
<h2>Mocking Strategies<a class="headerlink" href="#mocking-strategies" title="Link to this heading">¶</a></h2>
<section id="basic-mocking">
<h3>Basic Mocking<a class="headerlink" href="#basic-mocking" title="Link to this heading">¶</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">Mock()</span></code> for simple object mocking:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_with_mock</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test using a mock object.&quot;&quot;&quot;</span>
    <span class="n">mock_scene</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_scene</span><span class="o">.</span><span class="n">viewport_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1280</span><span class="p">,</span> <span class="mi">720</span><span class="p">)</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">MediaObject</span><span class="p">(</span><span class="s1">&#39;image.jpg&#39;</span><span class="p">,</span> <span class="n">mock_scene</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_scene</span> <span class="o">==</span> <span class="n">mock_scene</span>
</pre></div>
</div>
</section>
<section id="patch-decorators">
<h3>Patch Decorators<a class="headerlink" href="#patch-decorators" title="Link to this heading">¶</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">&#64;patch</span></code> to replace dependencies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">patch</span>

<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;pyvips.Image.new_from_file&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_run_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_new_from_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test successful image conversion.&quot;&quot;&quot;</span>
    <span class="n">mock_image</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">mock_image</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">mock_image</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">mock_image</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;uchar&#39;</span>
    <span class="n">mock_new_from_file</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_image</span>

    <span class="n">converter</span> <span class="o">=</span> <span class="n">VipsConverter</span><span class="p">(</span><span class="s2">&quot;input.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;output.ppm&quot;</span><span class="p">)</span>
    <span class="n">converter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">assert</span> <span class="n">converter</span><span class="o">.</span><span class="n">error</span> <span class="ow">is</span> <span class="kc">None</span>
    <span class="n">mock_new_from_file</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="magicmock-for-special-methods">
<h3>MagicMock for Special Methods<a class="headerlink" href="#magicmock-for-special-methods" title="Link to this heading">¶</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">MagicMock</span></code> when mocking magic methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">MagicMock</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_with_magic_mock</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test using MagicMock for special methods.&quot;&quot;&quot;</span>
    <span class="n">mock_obj</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
    <span class="n">mock_obj</span><span class="o">.</span><span class="fm">__len__</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">mock_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>
</pre></div>
</div>
</section>
</section>
<section id="assertion-patterns">
<h2>Assertion Patterns<a class="headerlink" href="#assertion-patterns" title="Link to this heading">¶</a></h2>
<section id="basic-assertions">
<h3>Basic Assertions<a class="headerlink" href="#basic-assertions" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equality</span>
<span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">expected_value</span>
<span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">wrong_value</span>

<span class="c1"># Identity</span>
<span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="n">same_obj</span>
<span class="k">assert</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="c1"># Membership</span>
<span class="k">assert</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">collection</span>
<span class="k">assert</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">collection</span>

<span class="c1"># Boolean</span>
<span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">flag</span> <span class="ow">is</span> <span class="kc">True</span>
<span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">flag</span> <span class="ow">is</span> <span class="kc">False</span>
</pre></div>
</div>
</section>
<section id="approximate-comparisons">
<h3>Approximate Comparisons<a class="headerlink" href="#approximate-comparisons" title="Link to this heading">¶</a></h3>
<p>For floating-point comparisons, use <code class="docutils literal notranslate"><span class="pre">pytest.approx()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_aim_x_no_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test velocity calculation with approx.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">aim</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">damping_factor</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">vx</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exception-testing">
<h3>Exception Testing<a class="headerlink" href="#exception-testing" title="Link to this heading">¶</a></h3>
<p>Test that exceptions are raised:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_getitem_nonexistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test KeyError for non-existent item.&quot;&quot;&quot;</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">TileCache</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">):</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[(</span><span class="s1">&#39;nonexistent&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="mock-assertions">
<h3>Mock Assertions<a class="headerlink" href="#mock-assertions" title="Link to this heading">¶</a></h3>
<p>Verify mock object interactions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_mock_calls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test mock method calls.&quot;&quot;&quot;</span>
    <span class="n">mock_obj</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>

    <span class="c1"># Call the mock</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">mock_obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="c1"># Verify calls</span>
    <span class="n">mock_obj</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">assert_called_once</span><span class="p">()</span>
    <span class="n">mock_obj</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="n">mock_obj</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">assert_called_with</span><span class="p">(</span><span class="s1">&#39;arg1&#39;</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">mock_obj</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">call_count</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="writing-new-tests">
<h2>Writing New Tests<a class="headerlink" href="#writing-new-tests" title="Link to this heading">¶</a></h2>
<section id="step-by-step-guide">
<h3>Step-by-Step Guide<a class="headerlink" href="#step-by-step-guide" title="Link to this heading">¶</a></h3>
<p><strong>1. Create Test File</strong></p>
<p>Match the structure of the source code:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Source: pyzui/tilesystem/tilecache.py
Test:   test/unittest/tilesystem/test_tilecache.py
</pre></div>
</div>
<p><strong>2. Import Dependencies</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span><span class="p">,</span> <span class="n">patch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyzui.module</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassToTest</span>
</pre></div>
</div>
<p><strong>3. Create Test Class</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestClassName</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature: Component Name</span>

<span class="sd">    Description of what is being tested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>4. Add Initialization Test</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scenario: Initialize with default values</span>

<span class="sd">    Given no custom parameters</span>
<span class="sd">    When creating an instance</span>
<span class="sd">    Then defaults should be set correctly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassToTest</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">attribute</span> <span class="o">==</span> <span class="n">default_value</span>
</pre></div>
</div>
<p><strong>5. Test Each Method</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_method_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scenario: Describe what method does</span>

<span class="sd">    Given preconditions</span>
<span class="sd">    When calling the method</span>
<span class="sd">    Then expected results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassToTest</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
</div>
<p><strong>6. Test Edge Cases</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_method_edge_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test method with boundary condition.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassToTest</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">edge_case_value</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected_edge_result</span>
</pre></div>
</div>
<p><strong>7. Test Error Handling</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_method_error</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test method handles errors gracefully.&quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassToTest</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="n">ExpectedError</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">invalid_input</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="test-template-example">
<h3>Test Template Example<a class="headerlink" href="#test-template-example" title="Link to this heading">¶</a></h3>
<p>Complete test file template:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tests for ModuleName component.</span>

<span class="sd">This test suite validates the ModuleName class which [description].</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">MagicMock</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyzui.module</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassName</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestClassName</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature: ClassName Component</span>

<span class="sd">    High-level description of component functionality and purpose.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># =======================</span>
    <span class="c1"># Initialization Tests</span>
    <span class="c1"># =======================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_init_default</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scenario: Initialize with default parameters</span>

<span class="sd">        Given no custom parameters</span>
<span class="sd">        When creating instance</span>
<span class="sd">        Then defaults should be applied</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">attribute</span> <span class="o">==</span> <span class="n">default_value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_init_custom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scenario: Initialize with custom parameters</span>

<span class="sd">        Given custom parameters</span>
<span class="sd">        When creating instance</span>
<span class="sd">        Then custom values should be used</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">(</span><span class="n">param</span><span class="o">=</span><span class="n">custom_value</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">attribute</span> <span class="o">==</span> <span class="n">custom_value</span>

    <span class="c1"># =======================</span>
    <span class="c1"># Property Tests</span>
    <span class="c1"># =======================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_property_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test property getter.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">property</span> <span class="o">==</span> <span class="n">expected_value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_property_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test property setter.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="n">new_value</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">property</span> <span class="o">==</span> <span class="n">new_value</span>

    <span class="c1"># =======================</span>
    <span class="c1"># Method Tests</span>
    <span class="c1"># =======================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_method_success</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scenario: Method executes successfully</span>

<span class="sd">        Given valid input</span>
<span class="sd">        When calling method</span>
<span class="sd">        Then expected output is returned</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected_output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_method_edge_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test method with edge case input.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">edge_case</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected_edge_output</span>

    <span class="c1"># =======================</span>
    <span class="c1"># Error Handling Tests</span>
    <span class="c1"># =======================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_method_invalid_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test method rejects invalid input.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">invalid_input</span><span class="p">)</span>

    <span class="c1"># =======================</span>
    <span class="c1"># Integration Tests</span>
    <span class="c1"># =======================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_integration_scenario</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scenario: Integration with real dependencies</span>

<span class="sd">        Given real file/resource</span>
<span class="sd">        When performing operation</span>
<span class="sd">        Then result should be valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">test_file</span><span class="p">):</span>
            <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Test file not found&quot;</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
</section>
<section id="testing-specific-components">
<h2>Testing Specific Components<a class="headerlink" href="#testing-specific-components" title="Link to this heading">¶</a></h2>
<section id="testing-physicalobject">
<h3>Testing PhysicalObject<a class="headerlink" href="#testing-physicalobject" title="Link to this heading">¶</a></h3>
<p><strong>Key Test Areas:</strong></p>
<ul class="simple">
<li><p>Initialization (position, velocity)</p></li>
<li><p>Movement (move, aim)</p></li>
<li><p>Physics simulation (step, damping)</p></li>
<li><p>Properties (zoomlevel, centre, moving)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestPhysicalObject</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_step_damping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test velocity damping during step.&quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="mf">100.0</span>
        <span class="n">initial_vx</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">vx</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="c1"># Velocity should be reduced</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">vx</span> <span class="o">&lt;</span> <span class="n">initial_vx</span>
        <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">vx</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="c1"># But not zero yet</span>
</pre></div>
</div>
</section>
<section id="testing-tilecache">
<h3>Testing TileCache<a class="headerlink" href="#testing-tilecache" title="Link to this heading">¶</a></h3>
<p><strong>Key Test Areas:</strong></p>
<ul class="simple">
<li><p>Initialization (maxsize, maxage)</p></li>
<li><p>Storage/retrieval (dict-like interface)</p></li>
<li><p>LRU eviction</p></li>
<li><p>Immortal tiles (None tiles, level-0)</p></li>
<li><p>Access counting (maxaccesses)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestTileCache</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_lru_eviction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test least recently used tiles are evicted.&quot;&quot;&quot;</span>
        <span class="n">cache</span> <span class="o">=</span> <span class="n">TileCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">cache</span><span class="p">[(</span><span class="s1">&#39;m1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
        <span class="n">cache</span><span class="p">[(</span><span class="s1">&#39;m2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
        <span class="n">cache</span><span class="p">[(</span><span class="s1">&#39;m3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>

        <span class="c1"># First tile should be evicted</span>
        <span class="k">assert</span> <span class="p">(</span><span class="s1">&#39;m1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span>
        <span class="k">assert</span> <span class="p">(</span><span class="s1">&#39;m2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cache</span>
        <span class="k">assert</span> <span class="p">(</span><span class="s1">&#39;m3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cache</span>
</pre></div>
</div>
</section>
<section id="testing-converters">
<h3>Testing Converters<a class="headerlink" href="#testing-converters" title="Link to this heading">¶</a></h3>
<p><strong>Key Test Areas:</strong></p>
<ul class="simple">
<li><p>Initialization (file paths, settings)</p></li>
<li><p>Threading behavior</p></li>
<li><p>Progress tracking</p></li>
<li><p>Error handling</p></li>
<li><p>Integration tests (real files)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestVipsConverter</span><span class="p">:</span>
    <span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;pyvips.Image.new_from_file&#39;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_run_converts_16bit_to_8bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test 16-bit to 8-bit conversion.&quot;&quot;&quot;</span>
        <span class="n">mock_image</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
        <span class="n">mock_image</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;ushort&#39;</span>  <span class="c1"># 16-bit</span>
        <span class="n">mock_image</span><span class="o">.</span><span class="n">cast</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">(</span><span class="n">return_value</span><span class="o">=</span><span class="n">mock_image</span><span class="p">)</span>
        <span class="n">mock_new</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">mock_image</span>

        <span class="n">converter</span> <span class="o">=</span> <span class="n">VipsConverter</span><span class="p">(</span><span class="s2">&quot;in.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;out.ppm&quot;</span><span class="p">)</span>
        <span class="n">converter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">mock_image</span><span class="o">.</span><span class="n">cast</span><span class="o">.</span><span class="n">assert_called_once_with</span><span class="p">(</span><span class="s1">&#39;uchar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="testing-tileproviders">
<h3>Testing TileProviders<a class="headerlink" href="#testing-tileproviders" title="Link to this heading">¶</a></h3>
<p><strong>Key Test Areas:</strong></p>
<ul class="simple">
<li><p>Initialization</p></li>
<li><p>Inheritance verification</p></li>
<li><p>Class attributes (filext, tilesize, aspect_ratio)</p></li>
<li><p>Boundary conditions (negative coords, out of range)</p></li>
<li><p>Tile generation</p></li>
<li><p>Error handling</p></li>
</ul>
<p><strong>Use the Template:</strong></p>
<p>For new DynamicTileProviders, use <code class="docutils literal notranslate"><span class="pre">test_new_dynamictileprovider_TEMPLATE.py</span></code>:</p>
<ol class="arabic simple">
<li><p>Copy template file</p></li>
<li><p>Rename to <code class="docutils literal notranslate"><span class="pre">test_yourprovider.py</span></code></p></li>
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">YourProvider</span></code> with actual class name</p></li>
<li><p>Update import paths</p></li>
<li><p>Customize test values</p></li>
<li><p>Uncomment and run tests</p></li>
</ol>
<p><strong>Template Structure:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestYourProvider</span><span class="p">:</span>
    <span class="c1"># Section 1: Basic initialization</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test provider initialization.&quot;&quot;&quot;</span>

    <span class="c1"># Section 2: Required attributes</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_filext_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test file extension.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_tilesize_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test tile size.&quot;&quot;&quot;</span>

    <span class="c1"># Section 3: Boundary conditions</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_load_dynamic_negative_row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test negative row handling.&quot;&quot;&quot;</span>

    <span class="c1"># Section 4: Tile generation</span>
    <span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;PIL.Image.new&#39;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_load_dynamic_valid_tile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_image</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test valid tile generation.&quot;&quot;&quot;</span>

    <span class="c1"># Section 5: Provider-specific tests</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_custom_logic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test provider-specific functionality.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="testing-windows-ui-components">
<h3>Testing Windows/UI Components<a class="headerlink" href="#testing-windows-ui-components" title="Link to this heading">¶</a></h3>
<p><strong>Special Considerations:</strong></p>
<ul class="simple">
<li><p>May require Qt application context</p></li>
<li><p>Use mocks for heavy Qt objects</p></li>
<li><p>Test logic separately from UI</p></li>
<li><p>Skip if display not available</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DISPLAY&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;No display available&quot;</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_qzui_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test QZUI widget initialization.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">PySide6.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">QApplication</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span> <span class="ow">or</span> <span class="n">QApplication</span><span class="p">([])</span>

    <span class="n">qzui</span> <span class="o">=</span> <span class="n">QZUI</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">qzui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<section id="general-guidelines">
<h3>General Guidelines<a class="headerlink" href="#general-guidelines" title="Link to this heading">¶</a></h3>
<p><strong>1. One Assert Per Test (When Possible)</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good - focused test</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_x_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">10.0</span>

<span class="c1"># Acceptable - related assertions</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_move_updates_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">PhysicalObject</span><span class="p">()</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">10.0</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">_y</span> <span class="o">==</span> <span class="mf">20.0</span>
</pre></div>
</div>
<p><strong>2. Descriptive Test Names</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good names</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_move_updates_position</span><span class="p">():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_move_with_negative_coordinates</span><span class="p">():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_zoom_maintains_centre_position</span><span class="p">():</span>

<span class="c1"># Bad names</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test1</span><span class="p">():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_stuff</span><span class="p">():</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_it_works</span><span class="p">():</span>
</pre></div>
</div>
<p><strong>3. Arrange-Act-Assert Pattern</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Arrange - set up test data</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
    <span class="n">input_value</span> <span class="o">=</span> <span class="mi">42</span>

    <span class="c1"># Act - perform the operation</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">input_value</span><span class="p">)</span>

    <span class="c1"># Assert - verify expectations</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected_value</span>
</pre></div>
</div>
<p><strong>4. Use Fixtures for Repeated Setup</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">physical_object</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide a PhysicalObject instance.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PhysicalObject</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_move</span><span class="p">(</span><span class="n">physical_object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test using fixture.&quot;&quot;&quot;</span>
    <span class="n">physical_object</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">physical_object</span><span class="o">.</span><span class="n">_x</span> <span class="o">==</span> <span class="mf">10.0</span>
</pre></div>
</div>
<p><strong>5. Test Behavior, Not Implementation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good - tests behavior</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_cache_evicts_old_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">TileCache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cache</span><span class="p">[</span><span class="s1">&#39;item1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
    <span class="n">cache</span><span class="p">[</span><span class="s1">&#39;item2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>

    <span class="k">assert</span> <span class="s1">&#39;item1&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cache</span>
    <span class="k">assert</span> <span class="s1">&#39;item2&#39;</span> <span class="ow">in</span> <span class="n">cache</span>

<span class="c1"># Bad - tests implementation details</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_cache_uses_ordereddict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="n">TileCache</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cache</span><span class="o">.</span><span class="n">_cache</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>6. Mock External Dependencies</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Good - mocks file I/O</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;builtins.open&#39;</span><span class="p">,</span> <span class="n">mock_open</span><span class="p">(</span><span class="n">read_data</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_file_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span>

<span class="c1"># Bad - depends on actual file system</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_file_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Creates real file!</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>7. Clean Up Resources</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_with_tempfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test with proper cleanup.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp</span><span class="p">:</span>
        <span class="n">outfile</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">name</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Perform test</span>
        <span class="n">process_file</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Clean up</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">outfile</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>8. Skip Tests When Dependencies Missing</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_integration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test with actual file.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">test_file</span><span class="p">):</span>
        <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test file not found: </span><span class="si">{</span><span class="n">test_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">test_file</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
<section id="common-pitfalls">
<h3>Common Pitfalls<a class="headerlink" href="#common-pitfalls" title="Link to this heading">¶</a></h3>
<p><strong>1. Testing Multiple Things</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad - tests too many things</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_everything</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">init_works</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">method1</span><span class="p">()</span> <span class="o">==</span> <span class="n">value1</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">method2</span><span class="p">()</span> <span class="o">==</span> <span class="n">value2</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span>

<span class="c1"># Good - separate tests</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">init_works</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_method1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">obj</span><span class="o">.</span><span class="n">method1</span><span class="p">()</span> <span class="o">==</span> <span class="n">value1</span>
</pre></div>
</div>
<p><strong>2. Order-Dependent Tests</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad - tests depend on execution order</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestBad</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_a_creates_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">create_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_b_reads_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Fails if test_a doesn&#39;t run first!</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>

<span class="c1"># Good - tests are independent</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TestGood</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">create_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Creates own test file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">content</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>3. Overly Specific Mocks</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad - too tightly coupled to implementation</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.ClassA&#39;</span><span class="p">)</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.ClassB&#39;</span><span class="p">)</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.function1&#39;</span><span class="p">)</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.function2&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">m3</span><span class="p">,</span> <span class="n">m4</span><span class="p">):</span>
    <span class="c1"># If implementation changes slightly, test breaks</span>

<span class="c1"># Good - mocks at boundaries</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.external_api_call&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_simpler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mock_api</span><span class="p">):</span>
    <span class="c1"># Mocks external dependency only</span>
    <span class="n">mock_api</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;ok&#39;</span><span class="p">}</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">process_data</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
<p><strong>4. Not Testing Edge Cases</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Incomplete - only tests happy path</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_divide</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>

<span class="c1"># Complete - tests edge cases</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_divide_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_divide_by_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ZeroDivisionError</span><span class="p">):</span>
        <span class="n">divide</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_divide_negative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">divide</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">5</span>
</pre></div>
</div>
<p><strong>5. Hardcoding Values</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bad - magic numbers</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">calculate</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">15</span>

<span class="c1"># Good - clear intent</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">base</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">multiplier</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="n">multiplier</span>
    <span class="k">assert</span> <span class="n">calculate</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">multiplier</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
</div>
</section>
</section>
<section id="coverage-goals">
<h2>Coverage Goals<a class="headerlink" href="#coverage-goals" title="Link to this heading">¶</a></h2>
<section id="target-metrics">
<h3>Target Metrics<a class="headerlink" href="#target-metrics" title="Link to this heading">¶</a></h3>
<p><strong>Line Coverage</strong>: Aim for &gt;80% coverage</p>
<p><strong>Branch Coverage</strong>: Aim for &gt;70% coverage</p>
<p><strong>Critical Paths</strong>: 100% coverage for:
- Error handling
- Boundary conditions
- Security-sensitive code
- Data corruption prevention</p>
</section>
<section id="generating-coverage-reports">
<h3>Generating Coverage Reports<a class="headerlink" href="#generating-coverage-reports" title="Link to this heading">¶</a></h3>
<p><strong>HTML Report:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--cov<span class="o">=</span>pyzui<span class="w"> </span>--cov-report<span class="o">=</span>html
open<span class="w"> </span>htmlcov/index.html
</pre></div>
</div>
<p><strong>Terminal Report:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--cov<span class="o">=</span>pyzui<span class="w"> </span>--cov-report<span class="o">=</span>term-missing
</pre></div>
</div>
<p><strong>Coverage for Specific Module:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>--cov<span class="o">=</span>pyzui.tilesystem<span class="w"> </span>--cov-report<span class="o">=</span>term
</pre></div>
</div>
</section>
<section id="interpreting-coverage">
<h3>Interpreting Coverage<a class="headerlink" href="#interpreting-coverage" title="Link to this heading">¶</a></h3>
<p><strong>Focus Areas:</strong></p>
<ol class="arabic simple">
<li><p><strong>High Coverage</strong> (&gt;90%):
- Core algorithms
- Data transformations
- Critical paths</p></li>
<li><p><strong>Medium Coverage</strong> (70-90%):
- UI components
- Integration code
- Helper utilities</p></li>
<li><p><strong>Lower Coverage Acceptable</strong> (&lt;70%):
- Experimental features
- Platform-specific code
- Debug utilities</p></li>
</ol>
</section>
</section>
<section id="continuous-integration">
<h2>Continuous Integration<a class="headerlink" href="#continuous-integration" title="Link to this heading">¶</a></h2>
<section id="running-tests-in-ci">
<h3>Running Tests in CI<a class="headerlink" href="#running-tests-in-ci" title="Link to this heading">¶</a></h3>
<p><strong>Example GitHub Actions Workflow:</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Unit Tests</span>

<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">pull_request</span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v2</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v2</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.12&#39;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pip install -r requirements.txt</span>
<span class="w">        </span><span class="no">pip install pytest pytest-cov</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">cd test/unittest</span>
<span class="w">        </span><span class="no">pytest --cov=pyzui --cov-report=xml</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload coverage</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecov/codecov-action@v2</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./coverage.xml</span>
</pre></div>
</div>
</section>
<section id="pre-commit-hooks">
<h3>Pre-commit Hooks<a class="headerlink" href="#pre-commit-hooks" title="Link to this heading">¶</a></h3>
<p><strong>Run tests before commit:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># .git/hooks/pre-commit</span>
<span class="c1">#!/bin/sh</span>
<span class="nb">cd</span><span class="w"> </span>test/unittest
pytest<span class="w"> </span>-x
<span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Tests failed. Commit aborted.&quot;</span>
<span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="k">fi</span>
</pre></div>
</div>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">¶</a></h2>
<section id="common-issues">
<h3>Common Issues<a class="headerlink" href="#common-issues" title="Link to this heading">¶</a></h3>
<p><strong>Import Errors:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution: Run from test/unittest directory</span>
<span class="nb">cd</span><span class="w"> </span>test/unittest
pytest

<span class="c1"># Or set PYTHONPATH</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/path/to/pyzui:<span class="nv">$PYTHONPATH</span>
pytest
</pre></div>
</div>
<p><strong>Qt Tests Failing:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Solution: Ensure Qt dependencies installed</span>
pip<span class="w"> </span>install<span class="w"> </span>PySide6

<span class="c1"># For headless environments, use virtual display</span>
Xvfb<span class="w"> </span>:99<span class="w"> </span>-screen<span class="w"> </span><span class="m">0</span><span class="w"> </span>1024x768x24<span class="w"> </span><span class="p">&amp;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">DISPLAY</span><span class="o">=</span>:99
pytest
</pre></div>
</div>
<p><strong>Slow Tests:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run specific test file instead of all</span>
pytest<span class="w"> </span>test_specific.py

<span class="c1"># Or run in parallel</span>
pytest<span class="w"> </span>-n<span class="w"> </span>auto
</pre></div>
</div>
<p><strong>Mock Not Working:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Problem: Mocking wrong path</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.Class&#39;</span><span class="p">)</span>  <span class="c1"># Wrong!</span>

<span class="c1"># Solution: Mock where it&#39;s used, not where defined</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;test_module.Class&#39;</span><span class="p">)</span>  <span class="c1"># Correct!</span>
</pre></div>
</div>
</section>
<section id="debugging-tests">
<h3>Debugging Tests<a class="headerlink" href="#debugging-tests" title="Link to this heading">¶</a></h3>
<p><strong>Print Debugging:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-v<span class="w"> </span>-s<span class="w"> </span>test_file.py::TestClass::test_method
</pre></div>
</div>
<p><strong>Use pdb:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">test_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">ClassName</span><span class="p">()</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pdb</span><span class="p">;</span> <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>  <span class="c1"># Debugger stops here</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span>
</pre></div>
</div>
<p><strong>Verbose Failure Output:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-vv<span class="w"> </span>test_file.py
</pre></div>
</div>
<p><strong>Show Locals on Failure:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>-l<span class="w"> </span>test_file.py
</pre></div>
</div>
</section>
</section>
<section id="quick-reference">
<h2>Quick Reference<a class="headerlink" href="#quick-reference" title="Link to this heading">¶</a></h2>
<section id="essential-commands">
<h3>Essential Commands<a class="headerlink" href="#essential-commands" title="Link to this heading">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run all tests</span>
pytest

<span class="c1"># Run with coverage</span>
pytest<span class="w"> </span>--cov<span class="o">=</span>pyzui

<span class="c1"># Run specific file</span>
pytest<span class="w"> </span>test_file.py

<span class="c1"># Run specific test</span>
pytest<span class="w"> </span>test_file.py::TestClass::test_method

<span class="c1"># Stop on first failure</span>
pytest<span class="w"> </span>-x

<span class="c1"># Show print output</span>
pytest<span class="w"> </span>-s

<span class="c1"># Parallel execution</span>
pytest<span class="w"> </span>-n<span class="w"> </span>auto

<span class="c1"># Generate HTML report</span>
pytest<span class="w"> </span>--html<span class="o">=</span>report.html
</pre></div>
</div>
</section>
<section id="essential-imports">
<h3>Essential Imports<a class="headerlink" href="#essential-imports" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">Mock</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">MagicMock</span><span class="p">,</span> <span class="n">mock_open</span>

<span class="c1"># Pytest features</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">()</span>      <span class="c1"># Floating point comparison</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">()</span>      <span class="c1"># Exception testing</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">()</span>        <span class="c1"># Skip test</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">()</span>     <span class="c1"># Test fixture</span>
<span class="n">pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">()</span>  <span class="c1"># Parameterized tests</span>
</pre></div>
</div>
</section>
<section id="common-patterns">
<h3>Common Patterns<a class="headerlink" href="#common-patterns" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mock object</span>
<span class="n">mock</span> <span class="o">=</span> <span class="n">Mock</span><span class="p">()</span>
<span class="n">mock</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">value</span>

<span class="c1"># Patch function</span>
<span class="nd">@patch</span><span class="p">(</span><span class="s1">&#39;module.function&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">(</span><span class="n">mock_func</span><span class="p">):</span>
    <span class="n">mock_func</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">value</span>

<span class="c1"># Expect exception</span>
<span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
    <span class="n">function</span><span class="p">(</span><span class="n">bad_input</span><span class="p">)</span>

<span class="c1"># Approximate comparison</span>
<span class="k">assert</span> <span class="n">value</span> <span class="o">==</span> <span class="n">pytest</span><span class="o">.</span><span class="n">approx</span><span class="p">(</span><span class="n">expected</span><span class="p">,</span> <span class="n">rel</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>

<span class="c1"># Skip test</span>
<span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
    <span class="n">pytest</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Reason for skipping&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Link to this heading">¶</a></h2>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Pytest</strong>: <a class="reference external" href="https://docs.pytest.org/">https://docs.pytest.org/</a></p></li>
<li><p><strong>Unittest.mock</strong>: <a class="reference external" href="https://docs.python.org/3/library/unittest.mock.html">https://docs.python.org/3/library/unittest.mock.html</a></p></li>
<li><p><strong>Coverage.py</strong>: <a class="reference external" href="https://coverage.readthedocs.io/">https://coverage.readthedocs.io/</a></p></li>
</ul>
</section>
<section id="pyzui-specific">
<h3>PyZUI-Specific<a class="headerlink" href="#pyzui-specific" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../technicaldocumentation/objectsystem.html"><span class="doc">Object System</span></a> - Understanding object architecture</p></li>
<li><p><a class="reference internal" href="../technicaldocumentation/tilingsystem.html"><span class="doc">Tiling System</span></a> - Understanding tile system</p></li>
<li><p><a class="reference internal" href="../technicaldocumentation/convertersystem.html"><span class="doc">Converter System</span></a> - Understanding converters</p></li>
<li><p><a class="reference internal" href="../technicaldocumentation/windowsystem.html"><span class="doc">Window System</span></a> - Understanding UI components</p></li>
</ul>
</section>
<section id="example-test-files">
<h3>Example Test Files<a class="headerlink" href="#example-test-files" title="Link to this heading">¶</a></h3>
<p>Reference these for patterns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">test/unittest/objects/mediaobjects/test_physicalobject.py</span></code> - Complete coverage example</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test/unittest/tilesystem/test_tilecache.py</span></code> - Cache testing patterns</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test/unittest/converters/test_vipsconverter.py</span></code> - Integration test example</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test/unittest/test_new_dynamictileprovider_TEMPLATE.py</span></code> - New component template</p></li>
</ul>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>The PyZUI test suite provides comprehensive coverage of all major components using pytest
and BDD-style documentation. When adding new features:</p>
<ol class="arabic simple">
<li><p>Write tests first (TDD) or alongside implementation</p></li>
<li><p>Follow existing patterns and conventions</p></li>
<li><p>Use the template for new DynamicTileProviders</p></li>
<li><p>Aim for &gt;80% coverage</p></li>
<li><p>Test edge cases and error handling</p></li>
<li><p>Keep tests independent and focused</p></li>
<li><p>Mock external dependencies</p></li>
<li><p>Document with Given-When-Then scenarios</p></li>
</ol>
<p>Well-tested code enables confident refactoring, prevents regressions, and serves as
executable documentation of expected behavior.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">PyZui</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/installation.html">PyZui installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/installation.html#running-pyzui">Running PyZUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted/installation.html#generating-documentation">Generating Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage Instructions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usageinstructions/userinterface.html">User Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usageinstructions/programconfiguration.html">Program Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/readingdocumentation.html">Reading Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/projectstructure.html">Project structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/objectsystem.html">Object System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/convertersystem.html">Converter System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/tiledmediaobject.html">Tiled media object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/tilingsystem.html">Tiling System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/windowsystem.html">Window System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technicaldocumentation/logging.html">Logging System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testing Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Unit Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="integrationtest.html">Integration Testing Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Benchmarks Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmarksdocumentation/qzuibenchmark.html">QZUI Benchmark Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarksdocumentation/converterbenchmark.html">Converter Benchmark Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution Guidelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributionguidelines/contributiongiudelines.html">Contribution Guidelines</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../technicaldocumentation/logging.html" title="previous chapter">Logging System</a></li>
      <li>Next: <a href="integrationtest.html" title="next chapter">Integration Testing Guide</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, David Roberts, Andrea Silvestri.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/testingdocumentation/unittest.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>